#!/usr/bin/env zsh
# creation commands
# list available images
# sdkmanager --list | grep system-images
# sudo sdkmanager --install "system-images;android-$VERSION;google_apis_playstore;x86_64"
# echo "no" | avdmanager create avd -n $NAME -k "system-images;android-$VERSION;google_apis_playstore;x86_64"
default_sdk_version=29
default_platform="platforms;android-$default_sdk_version"
default_image="system-images;android-$default_sdk_version;default;x86_64"
default_emulator_name="android-$default_sdk_version-emulator"
available_emulators=$(avdmanager list avd | grep Name | awk '{print $2}')
if [[ $default_emulator_name == *$available_emulators* ]]; then
    echo "No emulator found, creating one... with android-$default_sdk_version"
    echo "Y" | sdkmanager --install $default_platform $default_image
    echo "no" | avdmanager create avd -n $default_emulator_name -k $default_image
fi
echo "Starting emulator $default_emulator_name"
emulator @$default_emulator_name -no-boot-anim -noaudio -writable-system
